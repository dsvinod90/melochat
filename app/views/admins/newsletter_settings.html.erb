<%= render 'admin_submenu' %>
<div class='row justify-content-center'>
  <div class='content-font'>
    <h2 style='margin-top: 10px; text-align: center;'> Send Newsletters </h2>
  </div>
  <div class='content-font table-responsive' style='padding: 30px;'>
    <table class="table table-hover text-center">
      <thead>
        <tr>
          <th scope='col'>SL.NO.</th>
          <th scope='col'>Select</th>
          <th scope='col'>Name</th>
          <th scope='col'>Email</th>
          <th scope='col'>Subscription</th>
        </tr>
      </thead>
      <tbody>
        <%= form_with(url: send_newsletters_admins_path, method: 'get', data: { remote: false }) do |f| %>
          <% @users.each_with_index do |user, index| %>
            <tr>
              <td> <%= index+1 %> </td>
              <td> <%= f.check_box(:user_id, { multiple: true }, user.id, false) %> </td>
              <td> <%= user.name %> </td>
              <td> <%= user.email %> </td>
              <td> <%= user.subscribed ? 'Yes' : 'No' %> </td>
            </tr>
          <% end %>
          <%= f.submit 'Send to selected', class: 'btn btn-sm btn-success', style: 'margin: 5px;' %>
        <% end %>
      </tbody>
      <%= link_to 'Send to all', send_newsletters_admins_path, method: :get, params: {user_id: 'all'}, class: 'btn btn-sm btn-primary', style: 'margin: 5px;', data: { confirm: 'Are you sure you want to send newsletter to all subscribed users?' } %>
    </table>
  </div>
</div>
